<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="css/shop.css"/>
    <link rel="stylesheet" href="css/public.css"/>
</head>
<body>
        <header>
                <div class="margin">
                    <p id="headzuo">
                        <em></em>
                        <span>手机版</span>
                        <span>|</span>
                        <span>Q币充值</span>
                    </p>
                    <p id="headyou">
                        <span>欢迎你，只为<a href="">退出</a></span>
                        <span>|</span>
                        <span>我的订单</span>
                        <span>|</span>
                        <span>个人中心</span>
                        <span>|</span>
                        <span>帮助中心</span>
                        <span>|</span>
                        <span>游戏导航   ∨</span>
                    </p>
                </div>
        </header>
        <nav>
        <div class="margin">
        <div id="nt">
                <img src="img/nt-l.png" class="nt-l"/>
                <div id="sou">
                    <input type="text" id="sou-c" placeholder="输入道具进行搜索"/>
                    <inpu type="button" id="sou-r"/>
                </div>
                <img src="img/nt-r.png" class="nt-r"/>
        </div>
        
        <div id="nb">
            <ul>
                <li><a href="index.html">首页</a></li>
                <li><a href="list.html">商品列表</a></li>
                <li><a href="">活动专区</a></li>
                <li><a href="">限时折扣</a></li>
                <li><a href="">聚豆乐园</a></li>
                <li><a href="">周边商城</a></li>
                <li><a href="">个人中心</a></li>
                <li class="car"><s></s><a href="">购物车(  0  )</a></li>
            </ul>
        </div>
        
        </div>
        </nav>
        <div id="banner">
        <div class="margin">
            <dl>
                <dt>全部分类</dt>
                <dd>英雄</dd>
                <dd>表情</dd>
                <dd>海克斯及其他</dd>
                <dd>云顶之弈</dd>
                <dd class="te">皮肤</dd>
                <dd>道具</dd>
                <dd>守卫眼皮肤</dd>
                <dd>道具包</dd>
            </dl>
            <p>
                您现在的位置：<a href="">英雄联盟</a>  >  <a href="list.html">皮肤</a>  >  <a href="">道具详情</a>
            </p>
        </div>
        </div>
        <main>
        <div class="margin">
            <div id="ml">
                <h3>热门排行</h3>
                <ul>
                    <li>
                        <i>1</i>
                        <img src="https://game.gtimg.cn/images/daoju/dbm/lol/20170216_28862_2202.jpg"/>
                        <p>腥红之月  烬</p>
                        <p class="zz">Q币价：79.00Q币
                        </p>
                        <p>微信价：¥76.63</p>
                    </li>
                </ul>
            </div>
            <div id="mr">
                <div class="box">
                    <div class="box1">
                        <div class="myimg">  
                            <img src="https://game.gtimg.cn/images/daoju/app/lol/big/2-412014-9.jpg?_t=1574670714"/>
                            <span></span>
                        </div>
                        <div class="ddimg">
                            <img src="https://game.gtimg.cn/images/daoju/app/lol/big/2-412014-9.jpg?_t=1574670714"/>
                        </div>
                    </div>
                    <div class="box2">
                        <h3>未来战士  锤石</h3>
                        <p class="mqb">Q币价：79Q币</p>
                        <p class="mwx">微信价：<a class="rmb">¥76.63</a></p>
                        <p class="mm">期限：永久</p>
                        <a href="" class="sale">加入购物车</a>
                    </div>
                </div>
                
            </div>
        </div>
        </main>
        <div id="foot">
                <div class="margin">
                    <ul>
                        <li class="fl1">
                            <div class="fll">
                            <s></s>
                            </div>
                            <div class="flr">
                            <p class="fp1">我是新手</p>
                            <p>什么是道聚城</p>
                            <p>如何购买</p>
                            <p>如何赠送</p>
                            <p>如何获取聚豆</p>
                            </div>
                        </li>
                        <li class="fl2">
                            <div class="fll">
                            <s></s>
                            </div>
                            <div class="flr">
                            <p class="fp1">个人中心</p>
                            <p>发货时间</p>
                            <p>如何领取</p>
                            <p>补发规则</p>
                            <p>Vip价定义</p>
                            <p>道具状态定义</p>
                            </div>
                        </li>
                        <li class="fl3">
                            <div class="fll">
                            <s></s>
                            </div>
                            <div class="flr">
                            <p class="fp1">支付方式</p>
                            <p>支付方式</p>
                            <p>购物点支付</p>
                            <p>如何充值</p>
                            </div>
                        </li>
                        <li class="fl4">
                            <div class="fll">
                            <s></s>
                            </div>
                            <div class="flr">
                            <p class="fp1">腾讯在线服务</p>
                            <p>腾讯官方在线服务</p>
                            </div>
                        </li>
                        <li class="fl5">
                            <div class="f5-l">
                                <img src="https://js01.daoju.qq.com/common/images/mall/zsdjc.png"/>
                                <p>掌上道聚城</p>
                            </div>
                            <div class="f5-r">
                                    <img src="https://js01.daoju.qq.com/common/images/mall/wechatdjc.png"/>
                                    <p>道聚城公众号</p>
                            </div>
                        </li>
                    </ul>
                    <div class="ftxt">
                        <p>腾讯互动娱乐 | 服务条款| 腾讯游戏隐私保护指引| 腾讯游戏儿童隐私保护指引| 广告服务 | 腾讯游戏招聘 | 腾讯游戏客服 | 游戏地图 | 成长守护平台 | 商务合作 | 网站导航</p>
                        <p>COPYRIGHT © 1998 – 2019 TENCENT. ALL RIGHTS RESERVED.</p>
                        <p>腾讯公司 版权所有</p>
                    </div>
                </div>
            </div>
</body>
<script src="lib/jquery.js"></script>
<script src="lib/jj.json"></script>
<script src="lib/ajax.js"></script>
<script src="lib/cookie.js"></script>
<script>
    class dis{
        constructor(){
            this.box1=document.querySelector("#ml ul");
            this.box2=document.querySelector(".box");
            
            this.url="http://localhost:81/lib/jj.json";
         
            this.load();
        }
        load(){
            var that =this;
            ajaxGet(this.url,function(res){
                that.res = JSON.parse(res);
                that.display();
            })

            

        }

        display(){
            let str1=""
            for(var i=0;i<10;i++){
                str1 +=`
                <li>
                <i>${i/1+1}</i>
                <img src="${this.res[i].ximg}"/>
                <p>${this.res[i].name}</p>
                <p class="zz">Q币价：${this.res[i].price}Q币
                </p>
                <p>微信价：¥${this.res[i].wxprice}</p>
            </li>
                `
            }
            this.box1.innerHTML=str1;



            var url=location.search;
            var nn=url.substr(4,3);

            for(var n=0;n<this.res.length;n++){
                if(nn==this.res[n].num){
                    this.ni=n;
                }
            }

            var str2=`<div class="box1">
                        <div class="myimg">  
                            <img src="${this.res[this.ni].dimg}"/>
                            <span></span>
                        </div>
                        <div class="ddimg">
                            <img src="${this.res[this.ni].dimg}"/>
                        </div>
                    </div>
                    <div class="box2" index="${this.res[this.ni].num}">
                        <h3>${this.res[this.ni].name}</h3>
                        <p class="mqb">Q币价：${this.res[this.ni].price}Q币</p>
                        <p class="mwx">微信价：<a class="rmb">¥${this.res[this.ni].wxprice}</a></p>
                        <p class="mm">期限：永久</p>
                        <a href="" class="sale">加入购物车</a>
                    </div>`
                    this.box2.innerHTML=str2;

                    this.add();
        }
        add(){
            var that=this;
            this.box2.addEventListener("click",function(eve){
                var e=eve||window.event;
                var target=e.target||e.srcElement;
                if(target.className=="sale"){
                    that.id=target.parentNode.getAttribute("index");
                    that.setCook();
                }
            })
        }
        setCook(){
            this.goods=getCookie("goods")?JSON.parse(getCookie("goods")):[];


            if(this.goods.length<1){
                this.goods.push({
                    id:this.id,
                    num:1
                })
            }else{
                console.log(this.torrent)
                var i=0;
                var onoff = this.goods.some((val,idx)=>{
                        i=idx;
                    return val.id===this.id;
                });
                if(!onoff){
                    this.goods.push({
                        id:this.id,
                        num:1
                    })
                }else{
                    this.goods[i].num++;
                }
            }
            setCookie("goods",JSON.stringify(this.goods));
            alert("已添加到购物车")
        }
 

    }
    new dis();

    class jing{
			constructor(){
				this.sBox = document.querySelector(".myimg");
				this.sSpan = document.querySelector(".myimg span");
				this.bBox = document.querySelector(".ddimg");
                this.bImg = document.querySelector(".ddimg img");
                this.bbw=document.querySelector("main .margin")
                
				this.init()
			}
			init(){
				var that = this;
				this.sBox.onmouseover = function(){
					that.over()
				}
				this.sBox.onmousemove = function(eve){
					var e = eve || window.event;
					that.move(e)
				}
				this.sBox.onmouseout = function(){
					that.out()
				}
			}
			over(){
				this.sSpan.style.display = "block";
				this.bBox.style.display = "block";
				this.sSpanW = (this.bBox.offsetWidth / this.bImg.offsetWidth * this.sBox.offsetWidth);
				this.sSpanH = (this.bBox.offsetHeight / this.bImg.offsetHeight * this.sBox.offsetHeight);
				this.sSpan.style.width = this.sSpanW + "px";
				this.sSpan.style.height = this.sSpanH + "px";
				this.sW = this.sBox.offsetWidth;
				this.sH = this.sBox.offsetHeight;
				this.bW = this.bBox.offsetWidth;
				this.bH = this.bBox.offsetHeight;
				this.bImgW = this.bImg.offsetWidth;
                this.bImgH = this.bImg.offsetHeight;
                this.w1=this.bbw.offsetWidth/1+338;
                this.h1=this.bbw.offsetHeight/1+46;
			}
			move(e){
				var l = e.pageX - 683 - this.sSpan.offsetWidth/2;
				var t = e.pageY - 380 - this.sSpan.offsetHeight/2;
				if(l<0) l=0;
				if(t<0) t=0;
				if(l>this.sW - this.sSpanW){
					l = this.sW - this.sSpanW;
				}
				if(t>this.sH - this.sSpanH){
					t = this.sH - this.sSpanH;
				}
				this.sSpan.style.left = l + "px";
				this.sSpan.style.top = t + "px";
				this.bImg.style.left = l / (this.sW - this.sSpanW) * (this.bW - this.bImgW) + "px";
				this.bImg.style.top = t / (this.sH - this.sSpanH) * (this.bH - this.bImgH) + "px";
			}
			out(){
				this.sSpan.style.display = "none";
				this.bBox.style.display = "none";
			}
        }
        
    setTimeout(()=>{new jing()},300)
		
   


</script>
</html>